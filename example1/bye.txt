full refactor
change in master 1
