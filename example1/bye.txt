full refactor
change in master